/// Prisma schema model for `Workshop` table in database.
/// Here we model all the necesary data and information wee need for the Workshop activities, and related tables (tempData, attendance, speaker)
/// @author Kevin Bravo (kevinbravo.me)
import { AvaaYear } from "..\..\types"
import { Pensum } from "types-workshop"
import { ActivityStatus, Modality } from "..\type-activities"
import { ScholarAttendance } from "..\type-activities"
import { Scholar } from "..\..\users\scholar\scholar"

model Workshop {
    id                String               @id @default(nanoid(22))
    title             String
    spots             Int
    platform          String
    description       String
    calendarID        String?
    year              String
    workshopYear      AvaaYear[]
    modality          Modality
    pensum            Pensum
    dates             Json
    speaker           WorkshopSpeaker[]
    tempData          WorkshopTempData?
    activityStatus    ActivityStatus       @default(AGENDADO)
    scholarAttendance WorkshopAttendance[]

    @@index([title, modality, activityStatus, pensum])
}

model WorkshopTempData {
    id              String   @id @default(nanoid(22))
    workshop        Workshop @relation(fields: [workshopId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    workshopId      String   @unique
    formLink        String
    meetingLink     String?
    meetingId       String?
    meetingPassword String?
}

model WorkshopSpeaker {
    id            String     @id @default(nanoid(22))
    name          String
    email         String?    @unique
    birthdate     DateTime?
    yearsOfExp    Int?
    yearsInAvaa   Int?
    jobTitle      String?
    jobCompany    String?
    actualCity    String?
    actualCountry String?
    image         String?
    description   String?
    instagramUser String?
    twitterUser   String?
    linkedinUser  String?
    facebookUser  String?
    phoneNumber   String?
    raiting       Float?
    workshops     Workshop[]
}

model WorkshopAttendance {
    id            String            @id @default(nanoid(22))
    scholar       Scholar           @relation(fields: [scholarId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    scholarId     String
    workshopId    String           @unique
    workshop      Workshop          @relation(fields: [workshopId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    attendance    ScholarAttendance
    justification String?

    @@index([workshopId])
    @@index([scholarId])
}
