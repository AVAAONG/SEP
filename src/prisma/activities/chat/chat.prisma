/// Prisma schema model for `Chat` table in database.
/// Here we model all the necesary data and information wee need for the English Chat clubs, and related tables (tempData, attendance, speaker)
/// @author Kevin Bravo (kevinbravo.me)

import { ActivityStatus, Modality } from "..\type-activities"
import { Level } from "types-chat"
import { ScholarAttendance } from "..\type-activities"
import { Scholar } from "..\..\users\scholar\scholar"
import { Chat } from "..\..\schema"

model Chat {
    id             String           @id @default(nanoid(22))
    title          String
    dates          Json
    speaker        ChatSpeaker[]
    spots          Int
    platform       String
    calendarID     String?
    modality       Modality
    activityStatus ActivityStatus
    level          Level
    tempData       ChatsTempData?
    attendance     ChatAttendance[]

    @@index([title, modality, activityStatus, level])
}

model ChatAttendance {
    id            String            @id @default(nanoid(22))
    scholar       Scholar           @relation(fields: [scholarId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    scholarId     String
    chat          Chat              @relation(fields: [chatId], references: [id], onDelete: Cascade, onUpdate: Cascade)
    chatId        String
    attendance    ScholarAttendance
    justification String?

    @@index([scholarId])
    @@index([chatId])
}

model ChatsTempData {
    id              String  @id @default(nanoid(22))
    chat            Chat    @relation(fields: [chatId], references: [id])
    chatId          String  @unique
    formLink        String?
    meetingLink     String?
    meetingId       String?
    meetingPassword String?
    whatsappLink    String?
}

model ChatSpeaker {
    id            String    @id @default(nanoid(22))
    name          String
    email         String?   @unique
    birthDate     DateTime?
    yearsOfExp    Int?
    yearsInAvaa   Int?
    jobTitle      String?
    jobCompany    String?
    actualCity    String?
    actualCountry String?
    image         String?
    description   String?
    instagramUser String?
    twitterUser   String?
    linkedinUser  String?
    facebookUser  String?
    phoneNumber   String?
    raiting       Int?
    Chat          Chat[]
}
